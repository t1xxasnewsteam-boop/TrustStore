# üîß –ü—Ä–æ–±–ª–µ–º–∞ —Å SMTP –∏ —Ä–µ—à–µ–Ω–∏–µ

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–æ–≤–∞–π–¥–µ—Ä —Å–µ—Ä–≤–µ—Ä–∞ **–ë–õ–û–ö–ò–†–£–ï–¢ –ø–æ—Ä—Ç—ã 465 –∏ 587** (SMTP).

–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑:
```bash
nc -vz smtp.yandex.ru 465  # timeout
nc -vz smtp.yandex.ru 587  # timeout
```

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï 1: –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—ã —É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–õ–£–ß–®–ï–ï)

### –ù–∞–ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ö–æ—Å—Ç–∏–Ω–≥–∞:
```
–î–æ–±—Ä—ã–π –¥–µ–Ω—å!

–ü—Ä–æ—à—É —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ö–æ–¥—è—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –ø–æ—Ä—Ç—ã 465 –∏ 587 
–¥–ª—è SMTP-–æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º —Å —Å–µ—Ä–≤–µ—Ä–∞ 45.95.234.173

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å smtp.yandex.ru (–Ø–Ω–¥–µ–∫—Å 360)

–°–ø–∞—Å–∏–±–æ!
```

**–ü–æ—Å–ª–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**
```bash
pm2 restart trust-store
```

–ò –≤—Å–µ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç! ‚úÖ

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï 2: SendGrid HTTP API (–û–ë–•–û–î–ù–û–ô –ü–£–¢–¨)

–ï—Å–ª–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º SendGrid (—Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ HTTPS - –ø–æ—Ä—Ç 443).

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
npm install @sendgrid/mail
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `.env`:
```env
SENDGRID_API_KEY=—Ç–≤–æ–π_–∫–ª—é—á_–æ—Ç_sendgrid
```

### –ö–æ–¥ –≤ `server.js`:
```javascript
const sgMail = require('@sendgrid/mail');
sgMail.setApiKey(process.env.SENDGRID_API_KEY);

async function sendEmailViaSendGrid(data) {
    const msg = {
        to: data.to,
        from: 'orders@truststore.ru',
        subject: `‚úÖ –í–∞—à –∑–∞–∫–∞–∑ #${data.orderNumber}`,
        html: createOrderEmailHTML(data)
    };
    
    await sgMail.send(msg);
}
```

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï 3: Mail.ru Cloud SMTP

Mail.ru –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–≤.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
```env
EMAIL_HOST=smtp.mail.ru
EMAIL_PORT=465
EMAIL_SECURE=true
EMAIL_USER=—Ç–≤–æ–π@mail.ru
EMAIL_PASSWORD=–ø–∞—Ä–æ–ª—å_–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

1. **–°–Ω–∞—á–∞–ª–∞:** –ù–∞–ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ö–æ—Å—Ç–∏–Ω–≥–∞ - –æ–Ω–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É—é—Ç –∑–∞ 30 –º–∏–Ω—É—Ç
2. **–ï—Å–ª–∏ –æ—Ç–∫–∞–∑–∞–ª–∏:** –ò—Å–ø–æ–ª—å–∑—É–π SendGrid (100 –ø–∏—Å–µ–º/–¥–µ–Ω—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
3. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:** Mail.ru SMTP (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å VPS)

---

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** –ñ–¥–µ–º —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ—Ä—Ç–æ–≤ –æ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.

