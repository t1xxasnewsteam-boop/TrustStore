#!/usr/bin/expect -f
set timeout 30
spawn ssh root@45.95.234.173
expect "password:" { send "o-4zWa6SFWUGo\r" }
expect "# " { send "cd /root/TrustStore\r" }
expect "# " { send "sqlite3 analytics.db \"INSERT OR IGNORE INTO telegram_reviews (telegram_user_id, author_name, review_text, rating, telegram_comment_id, telegram_date, created_at) VALUES (0, 'Aleksey T', '–í—Å–µ —Å—É–ø–µ—Ä üëç –ö—É–ø–∏–ª —Å–æ —Å–∫–∏–¥–∫–æ–π –ø–æ –ø—Ä–æ–º–æ–∫–æ–¥—É, –¥–∞ –µ—â–µ –∏ –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ 30 –¥–Ω–µ–π –∏—Ç–æ–≥–æ 2 –º–µ—Å—è—Ü–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –∑–∞ 2–ö. –†–µ–±—è—Ç–∞ –æ—Ç–∑—ã–≤—á–∏–≤—ã–µ, –≤—Å–µ –æ–±—ä—è—Å–Ω–∏–ª–∏, –ø–æ–¥—Å–∫–∞–∑–∞–ª–∏. –ë—É–¥—É –æ–±—Ä–∞—â–∞—Ç—å—Å—è –µ—â—ë. –õ—É—á—à–µ –∏ –∏—Å–∫–∞—Ç—å –Ω–µ—á–µ–≥–æ. –°–ø–∞—Å–∏–±–æ –±–æ–ª—å—à–æ–µ —Ä–µ–±—è—Ç–∞–º –∏–∑ Trust Store, —É–¥–∞—á–∏ –∏ –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏—è –≤–∞–º, –ø—Ä–∏ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏—Ö —Ä–µ–∞–ª–∏—è—Ö –≤—ã –¥–µ–ª–∞–µ—Ç–µ –±–æ–ª—å—à–µ –¥–µ–ª–æ.', 5, 1273, 1730559360, CURRENT_TIMESTAMP);\"\r" }
expect "# " { send "sqlite3 analytics.db \"DELETE FROM telegram_reviews WHERE author_name = '–ê–Ω–¥—Ä–µ–π Benefiseller' AND telegram_comment_id < (SELECT MAX(telegram_comment_id) FROM telegram_reviews WHERE author_name = '–ê–Ω–¥—Ä–µ–π Benefiseller');\"\r" }
expect "# " { send "sqlite3 analytics.db \"UPDATE telegram_stats SET total_comments = (SELECT COUNT(*) FROM telegram_reviews) WHERE id = 1;\"\r" }
expect "# " { send "sqlite3 analytics.db \"ALTER TABLE telegram_stats ADD COLUMN IF NOT EXISTS last_update_id INTEGER DEFAULT 0;\" 2>/dev/null || echo 'Column exists'\r" }
expect "# " { send "sqlite3 analytics.db \"SELECT COUNT(*) as reviews_count, (SELECT total_comments FROM telegram_stats WHERE id = 1) as stats_count FROM telegram_reviews;\"\r" }
expect "# " { send "exit\r" }
expect eof

