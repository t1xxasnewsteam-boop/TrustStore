#!/usr/bin/expect -f

set timeout 30
set server "root@45.95.234.173"
set password "o-4zWa6SFWUGo,"

spawn ssh $server

expect {
    "password:" {
        send "$password\r"
    }
    "(yes/no)?" {
        send "yes\r"
        expect "password:"
        send "$password\r"
    }
}

expect "# "

send "cd /root/TrustStore\r"
expect "# "

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞
send "echo 'üìÖ –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è server.js:'\r"
expect "# "

send "stat server.js | grep Modify\r"
expect "# "

send "echo ''\r"
expect "# "

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–≥–¥–∞ –ø—Ä–∏—à–µ–ª webhook
send "echo '‚è∞ –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ webhook:'\r"
expect "# "

send "pm2 logs trust-store --lines 1000 --nostream | grep -E 'YOOMONEY WEBHOOK –ü–û–õ–£–ß–ï–ù.*ORD-1762026621082|1762026621082.*WEBHOOK' | head -1\r"
expect "# "

send "echo ''\r"
expect "# "

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –±—ã–ª–∞ –ª–∏ –æ—à–∏–±–∫–∞ —Å—É–º–º—ã
send "echo 'üîç –û—à–∏–±–∫–∏ —Å—É–º–º—ã –¥–ª—è —ç—Ç–æ–≥–æ –∑–∞–∫–∞–∑–∞:'\r"
expect "# "

send "pm2 logs trust-store --lines 1000 --nostream | grep -B 5 -A 5 '2182.5.*2250' | head -15\r"
expect "# "

send "exit\r"
expect eof

